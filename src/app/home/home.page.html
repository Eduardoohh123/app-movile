<ion-header [translucent]="true" class="custom-header" id="main-content">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="openMenu()">
        <ion-icon name="menu-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="header-logo-container">
      <img src="assets/imagenes/football-scoop.png" alt="Football Scoop Logo" class="header-logo" />
    </ion-title>
    <ion-buttons slot="end">
      <!-- Botones para usuarios autenticados -->
      <ng-container *ngIf="isAuthenticated">
        <ion-button (click)="openNotifications()" class="notification-button">
          <ion-icon name="notifications-outline"></ion-icon>
          <ion-badge *ngIf="unreadCount > 0" class="notification-badge">
            {{ unreadCount }}
          </ion-badge>
        </ion-button>
        <ion-button (click)="openProfile()">
          <ion-avatar class="header-avatar">
            <img [src]="currentUser?.avatar || 'https://ionicframework.com/docs/img/demos/avatar.svg'" alt="User avatar" />
          </ion-avatar>
        </ion-button>
      </ng-container>
      
      <!-- Botón de login para invitados -->
      <ion-button *ngIf="!isAuthenticated" (click)="navigateToLogin()" color="primary">
        <ion-icon slot="start" name="log-in-outline"></ion-icon>
        Iniciar Sesión
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- Fab Button para generar notificaciones de prueba (SOLO DESARROLLO - solo si está autenticado) -->
<ion-fab *ngIf="isAuthenticated" vertical="bottom" horizontal="end" slot="fixed" style="margin-bottom: 80px;">
  <ion-fab-button (click)="generateTestNotifications()" size="small" color="secondary">
    <ion-icon name="notifications-outline"></ion-icon>
  </ion-fab-button>
</ion-fab>

<ion-content [fullscreen]="true" class="home-content" (click)="onContentClick($event)">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="welcome-header">
      <div class="greeting-text">
        <h1>{{ getGreeting() }}</h1>
        <p>{{ isAuthenticated ? 'Bienvenido, ' + (currentUser?.name || 'Usuario') : 'Bienvenido a Football Scoop' }}</p>
      </div>
      <div class="date-badge">
        <ion-icon name="calendar-outline"></ion-icon>
        <span>{{ currentDate | date: 'dd MMM yyyy' }}</span>
      </div>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card" *ngFor="let stat of stats; let i = index" [attr.data-color-index]="i">
      <div class="stat-icon">
        <ion-icon [name]="stat.icon"></ion-icon>
      </div>
      <div class="stat-content">
        <h3>{{ stat.value }}</h3>
        <p>{{ stat.label }}</p>
      </div>
      <div class="stat-trend" [class.positive]="stat.trend > 0" [class.negative]="stat.trend < 0">
        <ion-icon [name]="stat.trend > 0 ? 'trending-up-outline' : 'trending-down-outline'"></ion-icon>
        <span>{{ stat.trend > 0 ? '+' : '' }}{{ stat.trend }}%</span>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="section-container">
    <div class="section-header">
      <h2>Acceso Rápido</h2>
      <ion-button fill="clear" size="small" (click)="viewAllActions()">
        Ver todas
        <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
      </ion-button>
    </div>
    
    <div class="quick-actions">
      <div class="action-card" *ngFor="let action of quickActions; let i = index" 
           [attr.data-action-index]="i" 
           (click)="handleAction(action.id)">
        <div class="action-icon">
          <ion-icon [name]="action.icon"></ion-icon>
        </div>
        <span class="action-label">{{ action.label }}</span>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="section-container">
    <div class="section-header">
      <h2>Últimas Noticias</h2>
      <ion-button fill="clear" size="small" (click)="viewAllActivity()">
        Ver todo
        <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
      </ion-button>
    </div>

    <div class="activity-list">
      <div class="activity-item" *ngFor="let activity of recentActivity; let i = index" 
           [attr.data-activity-index]="i">
        <div class="activity-icon">
          <ion-icon [name]="activity.icon"></ion-icon>
        </div>
        <div class="activity-content">
          <h4>{{ activity.title }}</h4>
          <p>{{ activity.description }}</p>
          <span class="activity-time">{{ activity.time }}</span>
        </div>
        <ion-button fill="clear" class="activity-action" (click)="handleActivity(activity.id)">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </ion-button>
      </div>
    </div>
  </div>

  <!-- Featured Content -->
  <div class="section-container">
    <div class="section-header">
      <h2>Noticias Destacadas</h2>
    </div>

    <div class="featured-cards">
      <div class="featured-card" *ngFor="let item of featuredItems" (click)="navigateToPage('/news')">
        <div class="featured-image">
          <img [src]="item.image" [alt]="item.title" />
          <div class="featured-overlay"></div>
          <ion-badge class="featured-badge" [color]="newsService.getCategoryColor(item.category)">
            {{ item.category }}
          </ion-badge>
        </div>
        <div class="featured-content">
          <h3>{{ item.title }}</h3>
          <p>{{ item.summary }}</p>
          <div class="featured-meta">
            <span class="meta-item">
              <ion-icon name="time-outline"></ion-icon>
              {{ item.time }}
            </span>
            <span class="meta-item">
              <ion-icon name="newspaper-outline"></ion-icon>
              Noticia
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Action Button -->
  <ion-fab slot="fixed" vertical="bottom" horizontal="end" class="custom-fab">
    <ion-fab-button (click)="openCreateMenu()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="top">
      <ion-fab-button color="light" (click)="createNew('article')" title="Nueva Noticia">
        <ion-icon name="newspaper-outline"></ion-icon>
      </ion-fab-button>
      <ion-fab-button color="light" (click)="createNew('match')" title="Añadir Partido">
        <ion-icon name="football-outline"></ion-icon>
      </ion-fab-button>
      <ion-fab-button color="light" (click)="createNew('video')" title="Subir Video">
        <ion-icon name="videocam-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab>

</ion-content>
